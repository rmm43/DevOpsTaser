<?xml version="1.0" encoding="utf-8"?>
<jdoc cUnit="net.sf.jabref.export.OpenOfficeDocumentCreator" jls="java5">
<jent id="0" type="file" span="0:0:130:1">Source/jabref/src/java/net/sf/jabref/export/OpenOfficeDocumentCreator.java</jent>
<jent id="1" pid="0" type="class" span="28:1:130:1">net.sf.jabref.export.OpenOfficeDocumentCreator</jent>
<jent id="2" pid="1" type="method" span="33:5:35:5">net.sf.jabref.export.OpenOfficeDocumentCreator.OpenOfficeDocumentCreator()</jent>
<jent id="3" pid="1" type="method" span="37:5:40:5">net.sf.jabref.export.OpenOfficeDocumentCreator.performExport(BibtexDatabase,MetaData,String,String,Set&lt;String&gt;)</jent>
<jent id="4" pid="1" type="method" span="42:5:64:5">net.sf.jabref.export.OpenOfficeDocumentCreator.storeOpenOfficeFile(File,InputStream)</jent>
<jent id="5" pid="1" type="method" span="66:5:80:5">net.sf.jabref.export.OpenOfficeDocumentCreator.exportOpenOfficeCalc(File,BibtexDatabase,Set&lt;String&gt;)</jent>
<jent id="6" pid="1" type="method" span="82:5:103:5">net.sf.jabref.export.OpenOfficeDocumentCreator.exportOpenOfficeCalcXML(File,BibtexDatabase,Set&lt;String&gt;)</jent>
<jent id="7" pid="1" type="method" span="105:5:110:5">net.sf.jabref.export.OpenOfficeDocumentCreator.addResourceFile(String,String,ZipOutputStream)</jent>
<jent id="8" pid="1" type="method" span="112:5:129:5">net.sf.jabref.export.OpenOfficeDocumentCreator.addFromResource(String,OutputStream)</jent>
<jtok eid="0" type="block_comment" span="1:1:5:4">/*
 * OpenOfficeDocumentCreator.java
 *
 * Created on February 16, 2005, 8:04 PM
 */</jtok>
<jtok eid="0" type="block_comment" span="25:1:27:4">/**
 * @author alver
 */</jtok>
<jtok eid="1" type="class_name" span="28:14:28:39">OpenOfficeDocumentCreator</jtok>
<jtok eid="1" type="class_or_interface_ref" span="28:48:28:60">ExportFormat</jtok>
<jtok eid="1" type="block_comment" span="30:5:32:8">/**
     * Creates a new instance of OpenOfficeDocumentCreator
     */</jtok>
<jtok eid="2" type="method_name" span="33:12:33:37">OpenOfficeDocumentCreator</jtok>
<jtok eid="2" type="primary_name_ref" span="34:15:34:22">Globals</jtok>
<jtok eid="2" type="method_call" span="34:23:34:27">lang</jtok>
<jtok eid="2" type="string_literal" span="34:28:34:45">"OpenOffice Calc"</jtok>
<jtok eid="2" type="string_literal" span="34:48:34:56">"oocalc"</jtok>
<jtok eid="2" type="string_literal" span="34:70:34:76">".sxc"</jtok>
<jtok eid="3" type="method_name" span="37:17:37:30">performExport</jtok>
<jtok eid="3" type="parameter_type" span="37:37:37:51">BibtexDatabase</jtok>
<jtok eid="3" type="parameter_name" span="37:52:37:60">database</jtok>
<jtok eid="3" type="parameter_type" span="37:68:37:76">MetaData</jtok>
<jtok eid="3" type="parameter_name" span="37:77:37:85">metaData</jtok>
<jtok eid="3" type="parameter_type" span="38:37:38:43">String</jtok>
<jtok eid="3" type="parameter_name" span="38:44:38:48">file</jtok>
<jtok eid="3" type="parameter_type" span="38:56:38:62">String</jtok>
<jtok eid="3" type="parameter_name" span="38:63:38:71">encoding</jtok>
<jtok eid="3" type="parameter_type" span="38:73:38:76">Set</jtok>
<jtok eid="3" type="parameter_type" span="38:77:38:83">String</jtok>
<jtok eid="3" type="parameter_name" span="38:85:38:91">keySet</jtok>
<jtok eid="3" type="throws" span="38:100:38:109">Exception</jtok>
<jtok eid="3" type="method_call" span="39:9:39:29">exportOpenOfficeCalc</jtok>
<jtok eid="3" type="constructor_call" span="39:34:39:38">File</jtok>
<jtok eid="3" type="primary_name_ref" span="39:39:39:43">file</jtok>
<jtok eid="3" type="primary_name_ref" span="39:46:39:54">database</jtok>
<jtok eid="3" type="primary_name_ref" span="39:56:39:62">keySet</jtok>
<jtok eid="4" type="method_name" span="42:24:42:43">storeOpenOfficeFile</jtok>
<jtok eid="4" type="parameter_type" span="42:44:42:48">File</jtok>
<jtok eid="4" type="parameter_name" span="42:49:42:53">file</jtok>
<jtok eid="4" type="parameter_type" span="42:55:42:66">InputStream</jtok>
<jtok eid="4" type="parameter_name" span="42:67:42:73">source</jtok>
<jtok eid="4" type="throws" span="42:82:42:91">Exception</jtok>
<jtok eid="4" type="class_or_interface_ref" span="43:9:43:24">ZipOutputStream</jtok>
<jtok eid="4" type="local_variable_name" span="43:25:43:28">out</jtok>
<jtok eid="4" type="constructor_call" span="43:35:43:50">ZipOutputStream</jtok>
<jtok eid="4" type="constructor_call" span="43:55:43:75">BufferedOutputStream</jtok>
<jtok eid="4" type="constructor_call" span="43:80:43:96">FileOutputStream</jtok>
<jtok eid="4" type="primary_name_ref" span="43:97:43:101">file</jtok>
<jtok eid="4" type="class_or_interface_ref" span="45:13:45:21">ZipEntry</jtok>
<jtok eid="4" type="local_variable_name" span="45:22:45:30">zipEntry</jtok>
<jtok eid="4" type="constructor_call" span="45:37:45:45">ZipEntry</jtok>
<jtok eid="4" type="string_literal" span="45:46:45:59">"content.xml"</jtok>
<jtok eid="4" type="primary_name_ref" span="46:13:46:16">out</jtok>
<jtok eid="4" type="method_call" span="46:17:46:29">putNextEntry</jtok>
<jtok eid="4" type="primary_name_ref" span="46:30:46:38">zipEntry</jtok>
<jtok eid="4" type="local_variable_name" span="47:17:47:18">c</jtok>
<jtok eid="4" type="primary_name_ref" span="48:21:48:22">c</jtok>
<jtok eid="4" type="primary_name_ref" span="48:25:48:31">source</jtok>
<jtok eid="4" type="method_call" span="48:32:48:36">read</jtok>
<jtok eid="4" type="primary_name_ref" span="49:17:49:20">out</jtok>
<jtok eid="4" type="method_call" span="49:21:49:26">write</jtok>
<jtok eid="4" type="primary_name_ref" span="49:27:49:28">c</jtok>
<jtok eid="4" type="primary_name_ref" span="51:13:51:16">out</jtok>
<jtok eid="4" type="method_call" span="51:17:51:27">closeEntry</jtok>
<jtok eid="4" type="line_comment" span="53:13:53:99">// Add manifest (required for OOo 2.0), "meta.xml", "mimetype" files. These are in the</jtok>
<jtok eid="4" type="line_comment" span="54:13:54:89">// resource/openoffice directory, and are copied verbatim into the zip file.</jtok>
<jtok eid="4" type="method_call" span="55:13:55:28">addResourceFile</jtok>
<jtok eid="4" type="string_literal" span="55:29:55:39">"meta.xml"</jtok>
<jtok eid="4" type="string_literal" span="55:41:55:72">"/resource/openoffice/meta.xml"</jtok>
<jtok eid="4" type="primary_name_ref" span="55:74:55:77">out</jtok>
<jtok eid="4" type="method_call" span="56:13:56:28">addResourceFile</jtok>
<jtok eid="4" type="string_literal" span="56:29:56:39">"mimetype"</jtok>
<jtok eid="4" type="string_literal" span="56:41:56:72">"/resource/openoffice/mimetype"</jtok>
<jtok eid="4" type="primary_name_ref" span="56:74:56:77">out</jtok>
<jtok eid="4" type="method_call" span="57:13:57:28">addResourceFile</jtok>
<jtok eid="4" type="string_literal" span="57:29:57:52">"META-INF/manifest.xml"</jtok>
<jtok eid="4" type="string_literal" span="57:54:57:89">"/resource/openoffice/manifest.xml"</jtok>
<jtok eid="4" type="primary_name_ref" span="57:91:57:94">out</jtok>
<jtok eid="4" type="line_comment" span="59:13:59:40">//zipEntry = new ZipEntry()</jtok>
<jtok eid="4" type="primary_name_ref" span="62:13:62:16">out</jtok>
<jtok eid="4" type="method_call" span="62:17:62:22">close</jtok>
<jtok eid="5" type="method_name" span="66:24:66:44">exportOpenOfficeCalc</jtok>
<jtok eid="5" type="parameter_type" span="66:45:66:49">File</jtok>
<jtok eid="5" type="parameter_name" span="66:50:66:54">file</jtok>
<jtok eid="5" type="parameter_type" span="66:56:66:70">BibtexDatabase</jtok>
<jtok eid="5" type="parameter_name" span="66:71:66:79">database</jtok>
<jtok eid="5" type="parameter_type" span="67:9:67:12">Set</jtok>
<jtok eid="5" type="parameter_type" span="67:13:67:19">String</jtok>
<jtok eid="5" type="parameter_name" span="67:21:67:27">keySet</jtok>
<jtok eid="5" type="throws" span="67:36:67:45">Exception</jtok>
<jtok eid="5" type="line_comment" span="70:9:70:70">// First store the xml formatted content to a temporary file.</jtok>
<jtok eid="5" type="class_or_interface_ref" span="71:9:71:13">File</jtok>
<jtok eid="5" type="local_variable_name" span="71:14:71:21">tmpFile</jtok>
<jtok eid="5" type="primary_name_ref" span="71:24:71:28">File</jtok>
<jtok eid="5" type="method_call" span="71:29:71:43">createTempFile</jtok>
<jtok eid="5" type="string_literal" span="71:44:71:52">"oocalc"</jtok>
<jtok eid="5" type="method_call" span="72:9:72:32">exportOpenOfficeCalcXML</jtok>
<jtok eid="5" type="primary_name_ref" span="72:33:72:40">tmpFile</jtok>
<jtok eid="5" type="primary_name_ref" span="72:42:72:50">database</jtok>
<jtok eid="5" type="primary_name_ref" span="72:52:72:58">keySet</jtok>
<jtok eid="5" type="line_comment" span="74:9:74:49">// Then add the content to the zip file:</jtok>
<jtok eid="5" type="class_or_interface_ref" span="75:9:75:28">BufferedInputStream</jtok>
<jtok eid="5" type="local_variable_name" span="75:29:75:31">in</jtok>
<jtok eid="5" type="constructor_call" span="75:38:75:57">BufferedInputStream</jtok>
<jtok eid="5" type="constructor_call" span="75:62:75:77">FileInputStream</jtok>
<jtok eid="5" type="primary_name_ref" span="75:78:75:85">tmpFile</jtok>
<jtok eid="5" type="method_call" span="76:9:76:28">storeOpenOfficeFile</jtok>
<jtok eid="5" type="primary_name_ref" span="76:29:76:33">file</jtok>
<jtok eid="5" type="primary_name_ref" span="76:35:76:37">in</jtok>
<jtok eid="5" type="line_comment" span="78:9:78:38">// Delete the temporary file:</jtok>
<jtok eid="5" type="primary_name_ref" span="79:9:79:16">tmpFile</jtok>
<jtok eid="5" type="method_call" span="79:17:79:23">delete</jtok>
<jtok eid="6" type="method_name" span="82:24:82:47">exportOpenOfficeCalcXML</jtok>
<jtok eid="6" type="parameter_type" span="82:48:82:52">File</jtok>
<jtok eid="6" type="parameter_name" span="82:53:82:60">tmpFile</jtok>
<jtok eid="6" type="parameter_type" span="82:62:82:76">BibtexDatabase</jtok>
<jtok eid="6" type="parameter_name" span="82:77:82:85">database</jtok>
<jtok eid="6" type="parameter_type" span="82:87:82:90">Set</jtok>
<jtok eid="6" type="parameter_type" span="82:91:82:97">String</jtok>
<jtok eid="6" type="parameter_name" span="82:99:82:105">keySet</jtok>
<jtok eid="6" type="class_or_interface_ref" span="83:9:83:23">OOCalcDatabase</jtok>
<jtok eid="6" type="local_variable_name" span="83:24:83:26">od</jtok>
<jtok eid="6" type="constructor_call" span="83:33:83:47">OOCalcDatabase</jtok>
<jtok eid="6" type="primary_name_ref" span="83:48:83:56">database</jtok>
<jtok eid="6" type="primary_name_ref" span="83:58:83:64">keySet</jtok>
<jtok eid="6" type="class_or_interface_ref" span="86:13:86:19">Writer</jtok>
<jtok eid="6" type="local_variable_name" span="86:20:86:22">ps</jtok>
<jtok eid="6" type="constructor_call" span="86:29:86:47">OutputStreamWriter</jtok>
<jtok eid="6" type="constructor_call" span="86:52:86:68">FileOutputStream</jtok>
<jtok eid="6" type="primary_name_ref" span="86:69:86:76">tmpFile</jtok>
<jtok eid="6" type="string_literal" span="86:79:86:85">"UTF8"</jtok>
<jtok eid="6" type="line_comment" span="89:17:89:67">//            Writer ps = new FileWriter(tmpFile);</jtok>
<jtok eid="6" type="class_or_interface_ref" span="90:17:90:26">DOMSource</jtok>
<jtok eid="6" type="local_variable_name" span="90:27:90:33">source</jtok>
<jtok eid="6" type="constructor_call" span="90:40:90:49">DOMSource</jtok>
<jtok eid="6" type="primary_name_ref" span="90:50:90:52">od</jtok>
<jtok eid="6" type="method_call" span="90:53:90:73">getDOMrepresentation</jtok>
<jtok eid="6" type="class_or_interface_ref" span="91:17:91:29">StreamResult</jtok>
<jtok eid="6" type="local_variable_name" span="91:30:91:36">result</jtok>
<jtok eid="6" type="constructor_call" span="91:43:91:55">StreamResult</jtok>
<jtok eid="6" type="primary_name_ref" span="91:56:91:58">ps</jtok>
<jtok eid="6" type="class_or_interface_ref" span="92:17:92:28">Transformer</jtok>
<jtok eid="6" type="local_variable_name" span="92:29:92:34">trans</jtok>
<jtok eid="6" type="primary_name_ref" span="92:37:92:55">TransformerFactory</jtok>
<jtok eid="6" type="method_call" span="92:56:92:67">newInstance</jtok>
<jtok eid="6" type="method_call" span="92:70:92:84">newTransformer</jtok>
<jtok eid="6" type="primary_name_ref" span="93:17:93:22">trans</jtok>
<jtok eid="6" type="method_call" span="93:23:93:40">setOutputProperty</jtok>
<jtok eid="6" type="primary_name_ref" span="93:41:93:51">OutputKeys</jtok>
<jtok eid="6" type="qualified_name_ref" span="93:52:93:58">INDENT</jtok>
<jtok eid="6" type="string_literal" span="93:60:93:65">"yes"</jtok>
<jtok eid="6" type="primary_name_ref" span="94:17:94:22">trans</jtok>
<jtok eid="6" type="method_call" span="94:23:94:32">transform</jtok>
<jtok eid="6" type="primary_name_ref" span="94:33:94:39">source</jtok>
<jtok eid="6" type="primary_name_ref" span="94:41:94:47">result</jtok>
<jtok eid="6" type="primary_name_ref" span="96:17:96:19">ps</jtok>
<jtok eid="6" type="method_call" span="96:20:96:25">close</jtok>
<jtok eid="6" type="class_or_interface_ref" span="98:18:98:27">Exception</jtok>
<jtok eid="6" type="local_variable_name" span="98:28:98:29">e</jtok>
<jtok eid="6" type="constructor_call" span="99:23:99:28">Error</jtok>
<jtok eid="6" type="primary_name_ref" span="99:29:99:30">e</jtok>
<jtok eid="7" type="method_name" span="105:25:105:40">addResourceFile</jtok>
<jtok eid="7" type="parameter_type" span="105:41:105:47">String</jtok>
<jtok eid="7" type="parameter_name" span="105:48:105:52">name</jtok>
<jtok eid="7" type="parameter_type" span="105:54:105:60">String</jtok>
<jtok eid="7" type="parameter_name" span="105:61:105:69">resource</jtok>
<jtok eid="7" type="parameter_type" span="105:71:105:86">ZipOutputStream</jtok>
<jtok eid="7" type="parameter_name" span="105:87:105:90">out</jtok>
<jtok eid="7" type="throws" span="105:99:105:110">IOException</jtok>
<jtok eid="7" type="class_or_interface_ref" span="106:9:106:17">ZipEntry</jtok>
<jtok eid="7" type="local_variable_name" span="106:18:106:26">zipEntry</jtok>
<jtok eid="7" type="constructor_call" span="106:33:106:41">ZipEntry</jtok>
<jtok eid="7" type="primary_name_ref" span="106:42:106:46">name</jtok>
<jtok eid="7" type="primary_name_ref" span="107:9:107:12">out</jtok>
<jtok eid="7" type="method_call" span="107:13:107:25">putNextEntry</jtok>
<jtok eid="7" type="primary_name_ref" span="107:26:107:34">zipEntry</jtok>
<jtok eid="7" type="method_call" span="108:9:108:24">addFromResource</jtok>
<jtok eid="7" type="primary_name_ref" span="108:25:108:33">resource</jtok>
<jtok eid="7" type="primary_name_ref" span="108:35:108:38">out</jtok>
<jtok eid="7" type="primary_name_ref" span="109:9:109:12">out</jtok>
<jtok eid="7" type="method_call" span="109:13:109:23">closeEntry</jtok>
<jtok eid="8" type="method_name" span="112:25:112:40">addFromResource</jtok>
<jtok eid="8" type="parameter_type" span="112:41:112:47">String</jtok>
<jtok eid="8" type="parameter_name" span="112:48:112:56">resource</jtok>
<jtok eid="8" type="parameter_type" span="112:58:112:70">OutputStream</jtok>
<jtok eid="8" type="parameter_name" span="112:71:112:74">out</jtok>
<jtok eid="8" type="class_or_interface_ref" span="113:9:113:12">URL</jtok>
<jtok eid="8" type="local_variable_name" span="113:13:113:16">url</jtok>
<jtok eid="8" type="primary_name_ref" span="113:19:113:44">OpenOfficeDocumentCreator</jtok>
<jtok eid="8" type="method_call" span="113:51:113:62">getResource</jtok>
<jtok eid="8" type="primary_name_ref" span="113:63:113:71">resource</jtok>
<jtok eid="8" type="class_or_interface_ref" span="115:13:115:24">InputStream</jtok>
<jtok eid="8" type="local_variable_name" span="115:25:115:27">in</jtok>
<jtok eid="8" type="primary_name_ref" span="115:30:115:33">url</jtok>
<jtok eid="8" type="method_call" span="115:34:115:44">openStream</jtok>
<jtok eid="8" type="local_variable_name" span="116:20:116:26">buffer</jtok>
<jtok eid="8" type="primary_name_ref" span="117:27:117:29">in</jtok>
<jtok eid="8" type="primary_name_ref" span="118:31:118:34">out</jtok>
<jtok eid="8" type="local_variable_name" span="120:29:120:38">bytesRead</jtok>
<jtok eid="8" type="primary_name_ref" span="120:41:120:43">in</jtok>
<jtok eid="8" type="method_call" span="120:44:120:48">read</jtok>
<jtok eid="8" type="primary_name_ref" span="120:49:120:55">buffer</jtok>
<jtok eid="8" type="primary_name_ref" span="121:29:121:38">bytesRead</jtok>
<jtok eid="8" type="primary_name_ref" span="122:25:122:28">out</jtok>
<jtok eid="8" type="method_call" span="122:29:122:34">write</jtok>
<jtok eid="8" type="primary_name_ref" span="122:35:122:41">buffer</jtok>
<jtok eid="8" type="primary_name_ref" span="122:46:122:55">bytesRead</jtok>
<jtok eid="8" type="class_or_interface_ref" span="126:18:126:29">IOException</jtok>
<jtok eid="8" type="local_variable_name" span="126:30:126:31">e</jtok>
<jtok eid="8" type="primary_name_ref" span="127:13:127:14">e</jtok>
<jtok eid="8" type="method_call" span="127:15:127:30">printStackTrace</jtok>
</jdoc>